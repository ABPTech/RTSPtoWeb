{{template "head.tmpl" .}}
<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h1 class="m-0 text-dark">Play hls video</h1>
      </div>
      <div class="col-sm-6">
        <ol class="breadcrumb float-sm-right">
          <li class="breadcrumb-item"><a href="/">Home</a></li>
          <li class="breadcrumb-item active">Play hls video</li>
        </ol>
      </div>
    </div>
  </div><!-- /.container-fluid -->
</div>
<div class="content">
  {{template "player.tmpl" .}}

  {{template "foot.tmpl" .}}
  </div>
  <script src="/../static/plugins/hlsjs/hls.min.js"></script>
<script>

  $(document).ready(()=>{
    startPlay();
  });
  function startPlay(){
    let uuid=$('#uuid').val();
    let url ='/stream/' + uuid + '/hls/live/index.m3u8';
    if ($("#videoPlayer")[0].canPlayType('application/vnd.apple.mpegurl')) {
        $("#videoPlayer")[0].src = url;
        $("#videoPlayer")[0].load();
    } else if (Hls.isSupported()) {
        let hls=new Hls({manifestLoadingTimeOut:60000, debug: true});
        hls.loadSource(url);
        hls.attachMedia($("#videoPlayer")[0]);
    } else {
          Swal.fire({
            icon: 'error',
            title: 'Oops...',
            text: 'Your browser don`t support hls '
          });
    }

  }

  $("#videoPlayer")[0].addEventListener('loadeddata', () => {
    $("#videoPlayer")[0].play();
    makePic();
  });
</script>
